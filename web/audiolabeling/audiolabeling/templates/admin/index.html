{% extends 'admin/master.html' %}
{% from "_macros.html" import render_field %}

{% block head_css %}
{{ super() }}
<link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">
{% endblock %}

{% block body %}

<div class="title">Get annotations</div>
<div id="get_annotations" class="al-form">
    <form action="/get_annotations">
        {{ getannotations_form.csrf_token }}
        {{ render_field(getannotations_form.project, placeholder="Project") }}
        <button type="submit">Submit</button>   
    </form>
</div>
{% endblock %}

{% block tail_js %}

{{ super() }}

<script type="text/javascript">

$("div.title").click(function(){
        $(this).next('div').toggle();
});

$(function() {
    $('#create_project_form').submit( function() {
        var form_data = new FormData(this);
        $.ajax({
            url: '/create_project',
            data: form_data,
            type: 'POST',
            contentType: false,
            processData: false,
            cache: false,
            success: function(response) {
                if(response.errors){
                    $('dd span.error').remove();
                    $.each(response.errors, function(key, value) {
                        $("<span class=\"error\">" + value + "</span>").insertAfter('dd input#' + key)
                    });
                }
                else{
                    window.location.reload();
                }
            },
            error: function(error) {
                alert("error");
            }
        });
        return false;
    });
});

</script>

{% endblock %}
